2025-09-19 00:04:16,538 - TrafficPrediction - INFO - === 交通车辆速度预测应用系统 ===
2025-09-19 00:04:16,538 - TrafficPrediction - INFO - 当前模式: train
2025-09-19 00:04:16,538 - TrafficPrediction - INFO - 开始模型训练...
2025-09-19 00:04:16,595 - src.model_training - INFO - 开始训练模型: gcn_gru_fuzzy, 数据集: Los-loop
2025-09-19 00:04:16,596 - src.model_training - INFO - 加载数据集: Los-loop
2025-09-19 00:04:16,954 - src.model_training - INFO - 已加载预训练的标准化器
2025-09-19 00:04:16,954 - src.model_training - INFO - 数据集加载完成: X形状=(32111, 12, 207), y形状=(32111, 207), 外部特征形状=(32111, 207, 10), 邻接矩阵形状=(207, 207)
2025-09-19 00:04:16,955 - src.model_training - INFO - 划分数据集...
2025-09-19 00:04:17,922 - src.model_training - INFO - 训练集大小: 19266
2025-09-19 00:04:17,923 - src.model_training - INFO - 验证集大小: 6422
2025-09-19 00:04:17,923 - src.model_training - INFO - 测试集大小: 6423
2025-09-19 00:04:18,016 - src.model_training - INFO - 创建模型，节点数: 207, 隐藏层大小: 64
2025-09-19 00:04:18,016 - src.model_structure - INFO - 创建模型: 节点数=207, 时间步=12, 隐藏层大小=64
2025-09-19 00:04:18,018 - TrafficPrediction - INFO - 初始化模糊推理系统...
2025-09-19 00:04:18,077 - src.model_structure - INFO - SpatioTemporalGCNGRU.call() called with inputs type: <class 'list'>
2025-09-19 00:04:18,078 - src.model_structure - INFO - Training mode: False
2025-09-19 00:04:18,078 - src.model_structure - INFO - Inputs is list/tuple with length: 3
2025-09-19 00:04:18,078 - src.model_structure - INFO - Speed sequences shape: (None, 12, 207)
2025-09-19 00:04:18,078 - src.model_structure - INFO - Adjacency matrix shape: (None, 207, 207)
2025-09-19 00:04:18,078 - src.model_structure - INFO - External features shape: (None, 207, 10)
2025-09-19 00:04:18,169 - src.model_structure - INFO - Predictions shape: (None, 207)
2025-09-19 00:04:18,182 - src.model_structure - INFO - 模型结构摘要:
2025-09-19 00:04:18,205 - src.model_structure - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)         ┃ Output Shape      ┃   Param # ┃ Connected to       ┃
┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│ input_layer_1        │ (None, 207, 207)  │         0 │ -                  │
│ (InputLayer)         │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ input_layer          │ (None, 12, 207)   │         0 │ -                  │
│ (InputLayer)         │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ expand_dims_1        │ (None, 1, 207,    │         0 │ input_layer_1[0][… │
│ (ExpandDims)         │ 207)              │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ expand_dims          │ (None, 12, 207,   │         0 │ input_layer[0][0]  │
│ (ExpandDims)         │ 1)                │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ tile (Tile)          │ (None, 12, 207,   │         0 │ expand_dims_1[0][… │
│                      │ 207)              │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape (Reshape)    │ (None, 207, 1)    │         0 │ expand_dims[0][0]  │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape_1 (Reshape)  │ (None, 207, 207)  │         0 │ tile[0][0]         │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gcn_layer (GCNLayer) │ (None, 207, 32)   │        64 │ reshape[0][0],     │
│                      │                   │           │ reshape_1[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ batch_normalization  │ (None, 207, 32)   │       128 │ gcn_layer[0][0]    │
│ (BatchNormalization) │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gcn_layer_1          │ (None, 207, 32)   │     1,056 │ batch_normalizati… │
│ (GCNLayer)           │                   │           │ reshape_1[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ input_layer_2        │ (None, 207, 10)   │         0 │ -                  │
│ (InputLayer)         │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ batch_normalization… │ (None, 207, 32)   │       128 │ gcn_layer_1[0][0]  │
│ (BatchNormalization) │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ mean (Mean)          │ (None, 10)        │         0 │ input_layer_2[0][… │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape_2 (Reshape)  │ (None, 12, 207,   │         0 │ batch_normalizati… │
│                      │ 32)               │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense (Dense)        │ (None, 64)        │       704 │ mean[0][0]         │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dropout (Dropout)    │ (None, 128)       │         0 │ dense[0][0],       │
│                      │                   │           │ dense_2[0][0]      │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape_3 (Reshape)  │ (None, 12, 6624)  │         0 │ reshape_2[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gru (GRU)            │ (None, 12, 64)    │ 1,284,480 │ reshape_3[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_1 (Dense)      │ (None, 32)        │     2,080 │ dropout[0][0]      │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gru_1 (GRU)          │ (None, 64)        │    24,960 │ gru[0][0]          │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ batch_normalization… │ (None, 32)        │       128 │ dense_1[0][0]      │
│ (BatchNormalization) │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ concatenate          │ (None, 96)        │         0 │ gru_1[0][0],       │
│ (Concatenate)        │                   │           │ batch_normalizati… │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_2 (Dense)      │ (None, 128)       │    12,416 │ concatenate[0][0]  │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_3 (Dense)      │ (None, 64)        │     8,256 │ dropout[1][0]      │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_4 (Dense)      │ (None, 207)       │    13,455 │ dense_3[0][0]      │
└──────────────────────┴───────────────────┴───────────┴────────────────────┘
 Total params: 1,347,855 (5.14 MB)
 Trainable params: 1,347,663 (5.14 MB)
 Non-trainable params: 192 (768.00 B)

2025-09-19 00:04:18,211 - src.model_training - INFO - 初始化模糊推理系统...
2025-09-19 00:04:18,211 - TrafficPrediction - INFO - 初始化模糊推理系统...
2025-09-19 00:04:18,211 - src.model_training - INFO - 模型目录已创建: D:\大三夏季学期\交通车辆速度预测应用系统\models
2025-09-19 00:04:18,211 - src.model_training - INFO - 临时禁用TensorBoard回调，使用TrainingVisualizer代替
2025-09-19 00:04:18,213 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - 开始训练模型: gcn_gru_fuzzy，数据集: Los-loop，总轮次: 100
2025-09-19 00:04:18,213 - src.model_training - INFO - 开始模型训练，共100轮
2025-09-19 00:05:31,314 - src.model_training - INFO - 轮次 1/100: 损失=0.163961, 验证损失=0.066137, 损失变化率=nan%, MAE=0.155984, 验证MAE=0.193932, RMSE=0.239472, 验证RMSE=0.234369, 平滑损失=0.163961 [最佳] [有效]
2025-09-19 00:05:31,316 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 1 完成: 训练损失=0.163961, 验证损失=0.066137, 损失变化率=0.00%
2025-09-19 00:06:37,978 - src.model_training - INFO - 轮次 2/100: 损失=0.033388, 验证损失=0.030566, 损失变化率=79.64%, MAE=0.102237, 验证MAE=0.102697, RMSE=0.166912, 验证RMSE=0.165862, 平滑损失=0.033388 [最佳] [有效]
2025-09-19 00:06:37,980 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 2 完成: 训练损失=0.033388, 验证损失=0.030566, 损失变化率=79.64%
2025-09-19 00:08:35,442 - src.model_training - INFO - 轮次 3/100: 损失=0.029118, 验证损失=0.028826, 损失变化率=12.79%, MAE=0.095612, 验证MAE=0.102563, RMSE=0.163037, 验证RMSE=0.163088, 平滑损失=0.029118 [最佳] [有效]
2025-09-19 00:08:35,461 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 3 完成: 训练损失=0.029118, 验证损失=0.028826, 损失变化率=12.79%
2025-09-19 00:10:00,306 - src.model_training - INFO - 轮次 4/100: 损失=0.028373, 验证损失=0.027788, 损失变化率=2.56%, MAE=0.093843, 验证MAE=0.095203, RMSE=0.161814, 验证RMSE=0.160453, 平滑损失=0.028373 [最佳] [有效]
2025-09-19 00:10:00,309 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 4 完成: 训练损失=0.028373, 验证损失=0.027788, 损失变化率=2.56%
2025-09-19 00:11:06,420 - src.model_training - INFO - 轮次 5/100: 损失=0.028190, 验证损失=0.027367, 损失变化率=0.65%, MAE=0.093508, 验证MAE=0.087894, RMSE=0.161618, 验证RMSE=0.159016, 平滑损失=0.056606 [最佳] [有效]
2025-09-19 00:11:06,422 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 5 完成: 训练损失=0.028190, 验证损失=0.027367, 损失变化率=0.65%
2025-09-19 00:12:14,704 - src.model_training - INFO - 轮次 6/100: 损失=0.028003, 验证损失=0.027433, 损失变化率=0.66%, MAE=0.093096, 验证MAE=0.087738, RMSE=0.161231, 验证RMSE=0.159684, 平滑损失=0.029414 [最佳] [有效]
2025-09-19 00:12:14,707 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 6 完成: 训练损失=0.028003, 验证损失=0.027433, 损失变化率=0.66%
2025-09-19 00:13:23,385 - src.model_training - INFO - 轮次 7/100: 损失=0.027741, 验证损失=0.028699, 损失变化率=0.93%, MAE=0.092405, 验证MAE=0.085195, RMSE=0.160688, 验证RMSE=0.163513, 平滑损失=0.028285 [最佳] [有效]
2025-09-19 00:13:23,388 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 7 完成: 训练损失=0.027741, 验证损失=0.028699, 损失变化率=0.93%
2025-09-19 00:14:31,190 - src.model_training - INFO - 轮次 8/100: 损失=0.027634, 验证损失=0.027001, 损失变化率=0.39%, MAE=0.092210, 验证MAE=0.092286, RMSE=0.160560, 验证RMSE=0.158845, 平滑损失=0.027988 [最佳] [有效]
2025-09-19 00:14:31,192 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 8 完成: 训练损失=0.027634, 验证损失=0.027001, 损失变化率=0.39%
2025-09-19 00:15:37,274 - src.model_training - INFO - 轮次 9/100: 损失=0.027456, 验证损失=0.027041, 损失变化率=0.64%, MAE=0.091567, 验证MAE=0.085063, RMSE=0.160092, 验证RMSE=0.158807, 平滑损失=0.027805 [最佳] [有效]
2025-09-19 00:15:37,277 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 9 完成: 训练损失=0.027456, 验证损失=0.027041, 损失变化率=0.64%
2025-09-19 00:16:45,577 - src.model_training - INFO - 轮次 10/100: 损失=0.027291, 验证损失=0.026916, 损失变化率=0.60%, MAE=0.091076, 验证MAE=0.086561, RMSE=0.159658, 验证RMSE=0.158245, 平滑损失=0.027625 [最佳] [有效]
2025-09-19 00:16:45,580 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 10 完成: 训练损失=0.027291, 验证损失=0.026916, 损失变化率=0.60%
2025-09-19 00:17:54,296 - src.model_training - INFO - 轮次 11/100: 损失=0.027256, 验证损失=0.026345, 损失变化率=0.13%, MAE=0.090764, 验证MAE=0.085604, RMSE=0.159567, 验证RMSE=0.156819, 平滑损失=0.027476 [最佳] [有效]
2025-09-19 00:17:54,299 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 11 完成: 训练损失=0.027256, 验证损失=0.026345, 损失变化率=0.13%
2025-09-19 00:19:02,329 - src.model_training - INFO - 轮次 12/100: 损失=0.027143, 验证损失=0.026122, 损失变化率=0.41%, MAE=0.090305, 验证MAE=0.085527, RMSE=0.159197, 验证RMSE=0.156221, 平滑损失=0.027356 [最佳] [有效]
2025-09-19 00:19:02,332 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 12 完成: 训练损失=0.027143, 验证损失=0.026122, 损失变化率=0.41%
2025-09-19 00:20:09,938 - src.model_training - INFO - 轮次 13/100: 损失=0.026978, 验证损失=0.032368, 损失变化率=0.61%, MAE=0.089880, 验证MAE=0.113048, RMSE=0.158810, 验证RMSE=0.172853, 平滑损失=0.027225 [最佳] [有效]
2025-09-19 00:20:09,941 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 13 完成: 训练损失=0.026978, 验证损失=0.032368, 损失变化率=0.61%
2025-09-19 00:21:17,888 - src.model_training - INFO - 轮次 14/100: 损失=0.027048, 验证损失=0.026631, 损失变化率=-0.26%, MAE=0.089857, 验证MAE=0.083682, RMSE=0.158931, 验证RMSE=0.157867, 平滑损失=0.027143 [最佳] [有效]
2025-09-19 00:21:17,892 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 14 完成: 训练损失=0.027048, 验证损失=0.026631, 损失变化率=-0.26%
2025-09-19 00:22:28,786 - src.model_training - INFO - 轮次 15/100: 损失=0.026803, 验证损失=0.026121, 损失变化率=0.91%, MAE=0.089428, 验证MAE=0.086947, RMSE=0.158479, 验证RMSE=0.156638, 平滑损失=0.027046 [最佳] [有效]
2025-09-19 00:22:28,788 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - Epoch 15 完成: 训练损失=0.026803, 验证损失=0.026121, 损失变化率=0.91%
