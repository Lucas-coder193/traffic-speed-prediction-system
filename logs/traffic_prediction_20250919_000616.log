2025-09-19 00:06:16,275 - TrafficPrediction - INFO - === 交通车辆速度预测应用系统 ===
2025-09-19 00:06:16,277 - TrafficPrediction - INFO - 当前模式: train
2025-09-19 00:06:16,278 - TrafficPrediction - INFO - 开始模型训练...
2025-09-19 00:06:16,584 - src.model_training - INFO - 开始训练模型: gcn_gru_fuzzy, 数据集: Los-loop
2025-09-19 00:06:16,593 - src.model_training - INFO - 加载数据集: Los-loop
2025-09-19 00:06:19,321 - src.model_training - INFO - 已加载预训练的标准化器
2025-09-19 00:06:19,328 - src.model_training - INFO - 数据集加载完成: X形状=(32111, 12, 207), y形状=(32111, 207), 外部特征形状=(32111, 207, 10), 邻接矩阵形状=(207, 207)
2025-09-19 00:06:19,333 - src.model_training - INFO - 划分数据集...
2025-09-19 00:06:24,077 - src.model_training - INFO - 训练集大小: 19266
2025-09-19 00:06:24,082 - src.model_training - INFO - 验证集大小: 6422
2025-09-19 00:06:24,083 - src.model_training - INFO - 测试集大小: 6423
2025-09-19 00:06:24,498 - src.model_training - INFO - 创建模型，节点数: 207, 隐藏层大小: 64
2025-09-19 00:06:24,503 - src.model_structure - INFO - 创建模型: 节点数=207, 时间步=12, 隐藏层大小=64
2025-09-19 00:06:24,514 - TrafficPrediction - INFO - 初始化模糊推理系统...
2025-09-19 00:06:24,775 - src.model_structure - INFO - SpatioTemporalGCNGRU.call() called with inputs type: <class 'list'>
2025-09-19 00:06:24,779 - src.model_structure - INFO - Training mode: False
2025-09-19 00:06:24,779 - src.model_structure - INFO - Inputs is list/tuple with length: 3
2025-09-19 00:06:24,780 - src.model_structure - INFO - Speed sequences shape: (None, 12, 207)
2025-09-19 00:06:24,780 - src.model_structure - INFO - Adjacency matrix shape: (None, 207, 207)
2025-09-19 00:06:24,780 - src.model_structure - INFO - External features shape: (None, 207, 10)
2025-09-19 00:06:25,437 - src.model_structure - INFO - Predictions shape: (None, 207)
2025-09-19 00:06:25,524 - src.model_structure - INFO - 模型结构摘要:
2025-09-19 00:06:25,618 - src.model_structure - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)         ┃ Output Shape      ┃   Param # ┃ Connected to       ┃
┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│ input_layer_1        │ (None, 207, 207)  │         0 │ -                  │
│ (InputLayer)         │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ input_layer          │ (None, 12, 207)   │         0 │ -                  │
│ (InputLayer)         │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ expand_dims_1        │ (None, 1, 207,    │         0 │ input_layer_1[0][… │
│ (ExpandDims)         │ 207)              │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ expand_dims          │ (None, 12, 207,   │         0 │ input_layer[0][0]  │
│ (ExpandDims)         │ 1)                │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ tile (Tile)          │ (None, 12, 207,   │         0 │ expand_dims_1[0][… │
│                      │ 207)              │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape (Reshape)    │ (None, 207, 1)    │         0 │ expand_dims[0][0]  │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape_1 (Reshape)  │ (None, 207, 207)  │         0 │ tile[0][0]         │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gcn_layer (GCNLayer) │ (None, 207, 32)   │        64 │ reshape[0][0],     │
│                      │                   │           │ reshape_1[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ batch_normalization  │ (None, 207, 32)   │       128 │ gcn_layer[0][0]    │
│ (BatchNormalization) │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gcn_layer_1          │ (None, 207, 32)   │     1,056 │ batch_normalizati… │
│ (GCNLayer)           │                   │           │ reshape_1[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ input_layer_2        │ (None, 207, 10)   │         0 │ -                  │
│ (InputLayer)         │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ batch_normalization… │ (None, 207, 32)   │       128 │ gcn_layer_1[0][0]  │
│ (BatchNormalization) │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ mean (Mean)          │ (None, 10)        │         0 │ input_layer_2[0][… │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape_2 (Reshape)  │ (None, 12, 207,   │         0 │ batch_normalizati… │
│                      │ 32)               │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense (Dense)        │ (None, 64)        │       704 │ mean[0][0]         │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dropout (Dropout)    │ (None, 128)       │         0 │ dense[0][0],       │
│                      │                   │           │ dense_2[0][0]      │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ reshape_3 (Reshape)  │ (None, 12, 6624)  │         0 │ reshape_2[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gru (GRU)            │ (None, 12, 64)    │ 1,284,480 │ reshape_3[0][0]    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_1 (Dense)      │ (None, 32)        │     2,080 │ dropout[0][0]      │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ gru_1 (GRU)          │ (None, 64)        │    24,960 │ gru[0][0]          │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ batch_normalization… │ (None, 32)        │       128 │ dense_1[0][0]      │
│ (BatchNormalization) │                   │           │                    │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ concatenate          │ (None, 96)        │         0 │ gru_1[0][0],       │
│ (Concatenate)        │                   │           │ batch_normalizati… │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_2 (Dense)      │ (None, 128)       │    12,416 │ concatenate[0][0]  │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_3 (Dense)      │ (None, 64)        │     8,256 │ dropout[1][0]      │
├──────────────────────┼───────────────────┼───────────┼────────────────────┤
│ dense_4 (Dense)      │ (None, 207)       │    13,455 │ dense_3[0][0]      │
└──────────────────────┴───────────────────┴───────────┴────────────────────┘
 Total params: 1,347,855 (5.14 MB)
 Trainable params: 1,347,663 (5.14 MB)
 Non-trainable params: 192 (768.00 B)

2025-09-19 00:06:25,633 - src.model_training - INFO - 初始化模糊推理系统...
2025-09-19 00:06:25,634 - TrafficPrediction - INFO - 初始化模糊推理系统...
2025-09-19 00:06:25,635 - src.model_training - INFO - 模型目录已创建: D:\大三夏季学期\交通车辆速度预测应用系统\models
2025-09-19 00:06:25,636 - src.model_training - INFO - 临时禁用TensorBoard回调，使用TrainingVisualizer代替
2025-09-19 00:06:25,641 - gcn_gru_fuzzy_Los-loop_visualizer - INFO - 开始训练模型: gcn_gru_fuzzy，数据集: Los-loop，总轮次: 100
2025-09-19 00:06:25,642 - src.model_training - INFO - 开始模型训练，共100轮
